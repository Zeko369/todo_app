# Migration `20201228195912-add-shared-lists`

This migration has been generated by Fran Zekan at 12/28/2020, 8:59:12 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."_sharedLists" (
"A" integer   NOT NULL ,
"B" integer   NOT NULL 
)

CREATE UNIQUE INDEX "_sharedLists_AB_unique" ON "public"."_sharedLists"("A", "B")

CREATE INDEX "_sharedLists_B_index" ON "public"."_sharedLists"("B")

ALTER TABLE "public"."_sharedLists" ADD FOREIGN KEY ("A")REFERENCES "public"."List"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_sharedLists" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200929180901-add-todo-type..20201228195912-add-shared-lists
--- datamodel.dml
+++ datamodel.dml
@@ -3,33 +3,34 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 enum Role {
   USER
   ADMIN
 }
 model User {
-  id        Int       @default(autoincrement()) @id
-  username  String    @unique
-  email     String    @unique
-  password  String
-  todos     Todo[]
-  tasks     Task[]
-  lists     List[]
-  tags      Tag[]
-  comments  Comment[]
-  role      Role      @default(USER)
-  createdAt DateTime  @default(now())
-  updatedAt DateTime  @updatedAt
+  id          Int       @id @default(autoincrement())
+  username    String    @unique
+  email       String    @unique
+  password    String
+  todos       Todo[]
+  tasks       Task[]
+  lists       List[]
+  tags        Tag[]
+  comments    Comment[]
+  sharedLists List[]    @relation("sharedLists")
+  role        Role      @default(USER)
+  createdAt   DateTime  @default(now())
+  updatedAt   DateTime  @updatedAt
 }
 model Comment {
-  id        Int      @default(autoincrement()) @id
+  id        Int      @id @default(autoincrement())
   title     String
   content   String?
   user      User     @relation(fields: [userId], references: [id])
   userId    Int
@@ -45,9 +46,9 @@
   REMINDER
 }
 model Todo {
-  id          Int       @default(autoincrement()) @id
+  id          Int       @id @default(autoincrement())
   pinned      Boolean   @default(false)
   title       String?
   description String?
   checked     Boolean   @default(false)
@@ -66,9 +67,9 @@
   updatedAt   DateTime  @updatedAt
 }
 model Task {
-  id        Int       @default(autoincrement()) @id
+  id        Int       @id @default(autoincrement())
   // tasks        Task[]    @relation("TaskToTask")
   // parentTask   Task?     @relation("TaskToTask", fields: [parentTaskId], references: [id])
   // parentTaskId Int?
   todo      Todo      @relation(fields: [todoId], references: [id])
@@ -81,20 +82,21 @@
   updatedAt DateTime  @updatedAt
 }
 model List {
-  id         Int       @default(autoincrement()) @id
+  id         Int       @id @default(autoincrement())
   title      String?
   todos      Todo[]
   user       User?     @relation(fields: [userId], references: [id])
+  sharedWith User[]    @relation("sharedLists")
   userId     Int?
   archivedAt DateTime?
   createdAt  DateTime  @default(now())
   updatedAt  DateTime  @updatedAt
 }
 model Tag {
-  id        Int      @default(autoincrement()) @id
+  id        Int      @id @default(autoincrement())
   text      String
   color     String?
   todos     Todo[]   @relation("Tags", references: [id])
   user      User?    @relation(fields: [userId], references: [id])
```


